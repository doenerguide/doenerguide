"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7342],{7342:(x,m,l)=>{l.r(m),l.d(m,{HomePage:()=>Y});var u=l(467),n=l(4438),r=l(1075),d=l(6727),_=l(3640),p=l(177),f=l(8056),h=l(70),F=l(2740);let v=(()=>{var o;class a{constructor(){}transform(t,e,s){return t.filter(c=>!e(c,s))}}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275pipe=n.EJ8({name:"filter",type:o,pure:!1,standalone:!0}),a})();var S=l(4239),P=l(9011),j=l(9885),R=l(3018),k=l(7291),C=l(8880);const G=["refreshButton"],$=["topButton"];function M(o,a){if(1&o){const i=n.RV6();n.j41(0,"ion-chip",30),n.bIt("click",function(){const e=n.eBV(i).$implicit,s=n.XpG();return n.Njj(s.handleFlag(e))}),n.EFF(1),n.k0s()}if(2&o){const i=a.$implicit;n.R7$(),n.SpI(" ",i.value," ")}}function I(o,a){if(1&o){const i=n.RV6();n.j41(0,"ion-chip",10),n.bIt("click",function(){const e=n.eBV(i).$implicit,s=n.XpG();return n.Njj(s.handleFlag(e))}),n.EFF(1),n.k0s()}if(2&o){const i=a.$implicit;n.R7$(),n.SpI(" ",i.value," ")}}function T(o,a){if(1&o){const i=n.RV6();n.j41(0,"ion-chip",30),n.bIt("click",function(){const e=n.eBV(i).$implicit,s=n.XpG();return n.Njj(s.handleFlag(e))}),n.EFF(1),n.k0s()}if(2&o){const i=a.$implicit;n.R7$(),n.SpI(" ",i.value," ")}}function b(o,a){if(1&o){const i=n.RV6();n.j41(0,"ion-chip",10),n.bIt("click",function(){const e=n.eBV(i).$implicit,s=n.XpG();return n.Njj(s.handleFlag(e))}),n.EFF(1),n.k0s()}if(2&o){const i=a.$implicit;n.R7$(),n.SpI(" ",i.value," ")}}function O(o,a){1&o&&(n.j41(0,"ion-item",31),n.nrm(1,"ion-spinner"),n.j41(2,"ion-label"),n.EFF(3,"D\xf6nerl\xe4den in deiner Umgebung werden geladen..."),n.k0s()())}function H(o,a){1&o&&(n.j41(0,"ion-label",32),n.EFF(1," Keine D\xf6nerl\xe4den in deiner Umgebung gefunden. "),n.k0s())}function B(o,a){if(1&o){const i=n.RV6();n.j41(0,"div",47),n.bIt("click",function(e){n.eBV(i);const s=n.XpG().$implicit;return n.XpG(2).userSrv.toggleFavorite(s),n.Njj(e.stopPropagation())}),n.nrm(1,"ion-icon",48),n.k0s()}if(2&o){const i=n.XpG().$implicit,t=n.XpG(2);n.R7$(),n.Y8G("name",t.userSrv.getFavoriteIds().includes(i.id)?"heart":"heart-outline")("color",t.userSrv.getFavoriteIds().includes(i.id)?"danger":"medium")}}function E(o,a){if(1&o&&(n.qex(0),n.EFF(1),n.nrm(2,"br"),n.bVm()),2&o){const i=a.$implicit;n.R7$(),n.SpI(" ","00:00"===i.open&&"00:00"===i.close?"Heute geschlossen":i.open+" - "+i.close,"")}}function y(o,a){if(1&o&&(n.j41(0,"ion-item",39),n.nrm(1,"ion-icon",49),n.EFF(2),n.k0s()),2&o){const i=n.XpG().$implicit,t=n.XpG(2);n.R7$(2),n.Lme(" ",t.shopFunctions.enabledFlags(i.flags).slice(0,3).join(", "),"",t.shopFunctions.enabledFlags(i.flags).length>3?", ...":""," ")}}function w(o,a){if(1&o&&(n.j41(0,"ion-item",39),n.nrm(1,"ion-icon",50),n.EFF(2),n.k0s()),2&o){const i=n.XpG().$implicit,t=n.XpG(2);n.R7$(2),n.Lme(" ",t.shopFunctions.disabledFlags(i.flags).slice(0,3).join(", "),"",t.shopFunctions.disabledFlags(i.flags).length>3?", ...":""," ")}}function N(o,a){if(1&o){const i=n.RV6();n.j41(0,"ion-col",34)(1,"ion-card",10),n.bIt("click",function(e){const s=n.eBV(i).$implicit,c=n.XpG(2);return n.Njj(c.navigateToShop(s,e))}),n.nrm(2,"ion-img",35),n.j41(3,"ion-card-header",36)(4,"div")(5,"ion-card-subtitle"),n.EFF(6),n.k0s(),n.j41(7,"ion-card-title"),n.EFF(8),n.nrm(9,"app-rating",37),n.k0s()(),n.DNE(10,B,2,2,"div",38),n.k0s(),n.j41(11,"ion-card-content")(12,"ion-list")(13,"ion-item",39),n.nrm(14,"ion-icon",40)(15,"app-price",41),n.k0s(),n.j41(16,"ion-item",39),n.nrm(17,"ion-icon",42),n.DNE(18,E,3,1,"ng-container",43),n.k0s(),n.DNE(19,y,3,2,"ion-item",44)(20,w,3,2,"ion-item",44),n.k0s()(),n.j41(21,"div",45)(22,"ion-button",46),n.EFF(23," Mehr Infos > "),n.k0s()()()()}if(2&o){const i=a.$implicit,t=n.XpG(2);n.R7$(2),n.FS9("alt",i.name),n.Y8G("src",i.imageUrl),n.R7$(4),n.JRh(i.address),n.R7$(2),n.SpI(" ",i.name," "),n.R7$(),n.Y8G("rating",i.rating),n.R7$(),n.Y8G("ngIf",t.userSrv.isLoggedIn()),n.R7$(5),n.Y8G("priceCategory",i.priceCategory),n.R7$(2),n.Y8G("color",t.shopFunctions.checkOpeningColor(i.openToday).status),n.R7$(),n.Y8G("ngForOf",i.openToday),n.R7$(),n.Y8G("ngIf",t.shopFunctions.enabledFlags(i.flags).length>0),n.R7$(),n.Y8G("ngIf",t.shopFunctions.disabledFlags(i.flags).length>0)}}function X(o,a){if(1&o&&(n.j41(0,"ion-grid")(1,"ion-row"),n.DNE(2,N,24,11,"ion-col",33),n.k0s()()),2&o){const i=n.XpG();n.R7$(2),n.Y8G("ngForOf",i.shownShops)}}let Y=(()=>{var o;class a{constructor(t,e,s,c,g,V,z,L){this.activatedRoute=t,this.toastCtrl=e,this.router=s,this.databaseSrv=c,this.userSrv=g,this.locationSrv=V,this.storageSrv=z,this.navCtrl=L,this.shownShops=[],this.shops=[],this.radiusShops=[],this.flags=[],this.nameFilter="",this.lat=52.520008,this.long=13.404954,this.radius=5,this.resultsShown=12,this.loading=!0,this.logoSrc="assets/logo_header.png",this.shopFunctions=d.o,this.flagList=F.z}ngOnInit(){this.locationSrv.getUserLocation().then(t=>{this.lat=t.lat,this.long=t.long,this.setShops()})}ionViewWillEnter(){this.storageSrv.darkMode().then(t=>{this.logoSrc=t?"assets/logo_header_white.png":"assets/logo_header.png"}),this.activatedRoute.snapshot.paramMap.get("message")&&this.toastCtrl.create({message:this.activatedRoute.snapshot.paramMap.get("message"),duration:2e3,color:"success",icon:"checkmark-circle-outline",position:"top"}).then(t=>{t.present(),this.router.navigate(["."],{queryParams:{message:null},queryParamsHandling:"merge"})})}pinFormatter(t){return`${t}km`}change_radius(t){this.radius=t.detail.value,this.locationSrv.setRadius(this.radius),this.setShops()}setShops(){var t=this;return(0,u.A)(function*(){t.radiusShops=(yield t.databaseSrv.getShops(t.lat,t.long,t.radius)).sort((e,s)=>e.distance&&s.distance?e.distance-s.distance:0),t.shops=t.radiusShops.filter(e=>t.filterShopsMethod(e)),t.setResultsShown(),t.loading=!1})()}setResultsShown(){this.shownShops=this.shops.slice(0,this.resultsShown)}loadMore(){this.resultsShown+=12,this.setResultsShown()}loadStandard(){this.resultsShown=12,this.setResultsShown()}onScroll(t){var e=this;return(0,u.A)(function*(){const s=yield e.content.getScrollElement();s.scrollTop>=s.scrollHeight-s.clientHeight-200&&e.loadMore(),s.scrollTop>=50?e.topButton.nativeElement.classList.remove("ion-hide"):e.topButton.nativeElement.classList.add("ion-hide")})()}filterShopsMethod(t){return 0===this.flags.length&&""===this.nameFilter||(""===this.nameFilter?this.flags.every(e=>t.flags[e.key]):0===this.flagList.length?t.name.toLowerCase().includes(this.nameFilter.toLowerCase()):t.name.toLowerCase().includes(this.nameFilter.toLowerCase())&&this.flags.every(e=>t.flags[e.key]))}handleFlag(t){this.flags.includes(t)?this.flags=this.flags.filter(e=>e!==t):this.flags.push(t),this.shops=this.radiusShops.filter(e=>this.filterShopsMethod(e)),this.setResultsShown()}fitlerFlags(t,e){return e.includes(t)}doRefresh(t,e){e&&e.nativeElement.classList.add("refreshing"),this.locationSrv.getUserLocation().then(s=>{this.lat=s.lat,this.long=s.long,this.setShops(),t&&t.detail.complete(),e&&setTimeout(()=>{e.nativeElement.classList.remove("refreshing"),this.toastCtrl.create({message:"Du siehst jetzt die neuen D\xf6nerl\xe4den in deiner N\xe4he!",duration:2e3,color:"success",icon:"checkmark-circle-outline",position:"top"}).then(c=>c.present())},1e3)})}filterShops(t){this.nameFilter=t.detail.value,this.shops=this.radiusShops.filter(e=>this.filterShopsMethod(e)),this.setResultsShown()}scrollToTop(){this.content.scrollToTop(500)}navigateToShop(t,e){e.target.classList.contains("favoriteButton")||this.navCtrl.navigateForward(["/shop",{shop:JSON.stringify(t)}])}}return(o=a).\u0275fac=function(t){return new(t||o)(n.rXU(h.nX),n.rXU(S.K_),n.rXU(h.Ix),n.rXU(P.B),n.rXU(j.D),n.rXU(R.N),n.rXU(k.n),n.rXU(C.q9))},o.\u0275cmp=n.VBU({type:o,selectors:[["app-home"]],viewQuery:function(t,e){if(1&t&&(n.GBs(G,5,n.aKT),n.GBs($,5,n.aKT),n.GBs(r.W9,5)),2&t){let s;n.mGM(s=n.lsd())&&(e.refButton=s.first),n.mGM(s=n.lsd())&&(e.topButton=s.first),n.mGM(s=n.lsd())&&(e.content=s.first)}},standalone:!0,features:[n.aNF],decls:41,vars:27,consts:[["refreshButton",""],["shops",""],["topButton",""],["alt","D\xf6nerGuide Logo",1,"ion-hide-md-up",3,"src"],[1,"ion-hide-md-down"],["size","3"],["alt","D\xf6nerGuide Logo",3,"src"],["size","4"],["placeholder","Suche nach D\xf6nerl\xe4den","show-clear-button","focus",3,"ionInput","debounce"],["size","1"],[3,"click"],["name","refresh"],["min","0","max","50","step","1","snaps","true","color","primary","pin","true",3,"ionChange","value","pinFormatter"],["size","small","slot","start","name","pin-outline"],["slot","end","name","pin-outline"],[1,"ion-hide-md-up","searchBar"],["placeholder","Suche nach D\xf6nerl\xe4den","show-clear-button","focus","animated","true",3,"ionInput","debounce"],[1,"flags"],["color","primary",3,"click",4,"ngFor","ngForOf"],[3,"click",4,"ngFor","ngForOf"],[1,"ion-padding",3,"ionScroll","scrollEvents"],["slot","fixed",1,"ion-hide-md-up",3,"ionRefresh","pullMin","pullMax","pullFactor"],["pullingText","Zum Aktualisieren ziehen","refreshingText","Lade neue D\xf6nerl\xe4den in deiner N\xe4he..."],[1,"ion-hide-md-up"],["min","0","max","50","step","1","snaps","true","color","primary","pin","true",1,"range",3,"ionChange","value","pinFormatter"],[1,"flags","md","ion-hide-md-down"],[3,"ngIf"],[3,"ngIf","ngIfElse"],["size","large","id","topButton",1,"ion-hide",3,"click"],["name","chevron-up-outline","slot","icon-only"],["color","primary",3,"click"],["lines","none",1,"loadingShops"],[1,"loadingShops"],["size","12","size-sm","6","size-md","4","size-lg","3",4,"ngFor","ngForOf"],["size","12","size-sm","6","size-md","4","size-lg","3"],[3,"src","alt"],[1,"title"],[3,"rating"],["class","favoriteButton",3,"click",4,"ngIf"],["lines","none"],["slot","start","name","pricetag-outline"],[3,"priceCategory"],["slot","start","name","time-outline",3,"color"],[4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],[1,"buttons"],["fill","clear"],[1,"favoriteButton",3,"click"],[1,"size",3,"name","color"],["slot","start","name","checkmark-outline","color","open"],["slot","start","name","close-outline","color","danger"]],template:function(t,e){if(1&t){const s=n.RV6();n.j41(0,"ion-header")(1,"ion-toolbar"),n.nrm(2,"img",3),n.j41(3,"ion-grid",4)(4,"ion-row")(5,"ion-col",5),n.nrm(6,"img",6),n.k0s(),n.j41(7,"ion-col",7)(8,"ion-searchbar",8),n.bIt("ionInput",function(g){return n.eBV(s),n.Njj(e.filterShops(g))}),n.k0s()(),n.j41(9,"ion-col",9)(10,"ion-button",10,0),n.bIt("click",function(){return n.eBV(s),n.Njj(e.doRefresh(void 0,e.refButton))}),n.nrm(12,"ion-icon",11),n.k0s()(),n.j41(13,"ion-col",7)(14,"ion-range",12),n.bIt("ionChange",function(g){return n.eBV(s),n.Njj(e.change_radius(g))}),n.nrm(15,"ion-icon",13)(16,"ion-icon",14),n.k0s()()()()(),n.j41(17,"div",15)(18,"ion-searchbar",16),n.bIt("ionInput",function(g){return n.eBV(s),n.Njj(e.filterShops(g))}),n.k0s(),n.j41(19,"div",17),n.DNE(20,M,2,1,"ion-chip",18)(21,I,2,1,"ion-chip",19),n.nI1(22,"filter"),n.k0s()()(),n.j41(23,"ion-content",20),n.bIt("ionScroll",function(g){return n.eBV(s),n.Njj(e.onScroll(g))}),n.j41(24,"ion-refresher",21),n.bIt("ionRefresh",function(g){return n.eBV(s),n.Njj(e.doRefresh(g))}),n.nrm(25,"ion-refresher-content",22),n.k0s(),n.j41(26,"div",23)(27,"ion-range",24),n.bIt("ionChange",function(g){return n.eBV(s),n.Njj(e.change_radius(g))}),n.nrm(28,"ion-icon",13)(29,"ion-icon",14),n.k0s()(),n.j41(30,"div",25),n.DNE(31,T,2,1,"ion-chip",18)(32,b,2,1,"ion-chip",19),n.nI1(33,"filter"),n.k0s(),n.DNE(34,O,4,0,"ng-template",26)(35,H,2,0,"ng-template",27)(36,X,3,1,"ng-template",null,1,n.C5r),n.j41(38,"ion-button",28,2),n.bIt("click",function(){return n.eBV(s),n.Njj(e.scrollToTop())}),n.nrm(40,"ion-icon",29),n.k0s()()}if(2&t){const s=n.sdS(37);n.R7$(2),n.Y8G("src",e.logoSrc,n.B4B),n.R7$(4),n.Y8G("src",e.logoSrc,n.B4B),n.R7$(2),n.Y8G("debounce",500),n.R7$(6),n.Y8G("value",e.radius)("pinFormatter",e.pinFormatter),n.R7$(4),n.Y8G("debounce",500),n.R7$(2),n.Y8G("ngForOf",e.flags),n.R7$(),n.Y8G("ngForOf",n.brH(22,19,e.flagList,e.fitlerFlags,e.flags)),n.R7$(2),n.Y8G("scrollEvents",!0),n.R7$(),n.Y8G("pullMin",80)("pullMax",200)("pullFactor",.5),n.R7$(3),n.Y8G("value",e.radius)("pinFormatter",e.pinFormatter),n.R7$(4),n.Y8G("ngForOf",e.flags),n.R7$(),n.Y8G("ngForOf",n.brH(33,23,e.flagList,e.fitlerFlags,e.flags)),n.R7$(2),n.Y8G("ngIf",e.loading),n.R7$(),n.Y8G("ngIf",!e.loading&&0===e.shownShops.length)("ngIfElse",s)}},dependencies:[r.bv,r.Jm,r.b_,r.I9,r.ME,r.HW,r.tN,r.ZB,r.hU,r.W9,r.lO,r.eU,r.iq,r.KW,r.uz,r.he,r.nf,r.Ob,r.To,r.Ki,r.ln,r.S1,r.w2,r.ai,r.su,r.Gw,_.X,p.MD,p.Sq,p.bT,f.F,h.iI,v],styles:["ion-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px;margin-left:20px}ion-card[_ngcontent-%COMP%]{margin:10px 0}ion-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;height:180px;object-fit:cover}.ion-padding[_ngcontent-%COMP%]{--padding-top: 0;padding-top:0;width:100%}ion-card-content[_ngcontent-%COMP%]{padding-bottom:0}.loadingShops[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);width:100%}.loadingShops[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin:0 20px}ion-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center}ion-col[_ngcontent-%COMP%]{display:flex;align-items:center}ion-range[_ngcontent-%COMP%]{padding:12px 0}ion-content[_ngcontent-%COMP%]   ion-range[_ngcontent-%COMP%]{margin-top:12px}ion-toolbar[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{padding:10px 0}.searchBar[_ngcontent-%COMP%]{position:sticky;z-index:9999;background-color:var(--ion-background-color)!important;box-shadow:0 0 14px #0000001a}.flags[_ngcontent-%COMP%]{padding-bottom:10px;display:flex;flex-direction:row;align-items:center;overflow:auto}.flags.md[_ngcontent-%COMP%]{margin-top:15px}ion-chip[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-width:-moz-fit-content;min-width:fit-content}ion-content[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{padding:0}ion-refresher[_ngcontent-%COMP%]{margin-top:20px}.refreshing[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate 1s linear infinite}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}#topButton[_ngcontent-%COMP%]{position:sticky;bottom:0;float:right;z-index:9999}"]}),a})()}}]);